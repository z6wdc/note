---
title: CAP Theorem
date: 2025-04-02 18:07:39
tags:
---
CAP 理論是由美國計算機科學家 Eric Brewer 提出，指出在一個**分散式資料庫系統**中，以下三者無法同時完全滿足，只能選擇其中兩個：

- **C：Consistency（一致性）**
- **A：Availability（可用性）**
- **P：Partition Tolerance（分區容忍性）**

---

## 三要素說明

### 一致性（Consistency）
所有節點在同一時間看到的資料都是一致的。例如：使用者 A 寫入後，使用者 B 馬上讀到同樣的資料。

### 可用性（Availability）
每個請求都能在合理時間內獲得回應，即使部分節點有問題也能繼續提供服務。

### 分區容忍性（Partition Tolerance）
系統能容忍網路分區或節點之間通訊中斷的情況，仍然能繼續運作。

---

## 為什麼不能三者兼得？

當網路分區（P）發生時，必須在「一致性（C）」與「可用性（A）」之間做出選擇：

- 如果選擇 **一致性（C）**，系統會犧牲可用性來保證資料一致性（可能暫時拒絕請求）。
- 如果選擇 **可用性（A）**，系統會犧牲一致性來保持服務持續可用（可能讀到舊資料）。

---

## CAP 組合與代表系統

| 類型 | 組合                 | 特性說明                     | 代表系統                         |
|------|----------------------|------------------------------|----------------------------------|
| CP   | 一致性 + 分區容忍性 | 保證一致性，但可能暫時無法服務 | HBase、MongoDB（某些設定）       |
| AP   | 可用性 + 分區容忍性 | 系統持續可用，但資料可能不同步 | Cassandra、CouchDB              |
| CA   | 一致性 + 可用性     | 僅適用於單節點，無法容忍分區   | 傳統單機資料庫（非分散式系統）   |

> **現代分散式系統幾乎都會選擇 P（分區容忍性），因為網路分區是不可避免的情況。**

---

## 小結

- 分散式系統中 CAP 三者不可兼得，只能取其二。
- 系統設計需根據業務需求，在一致性與可用性中取得平衡。
